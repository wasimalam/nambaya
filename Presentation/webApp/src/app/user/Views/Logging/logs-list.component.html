<div class="main-heading">
  <h4 class="sample-title" translate><span (click)="goBack()" class="icon-previous"></span> Logs List</h4>
</div>
<div class="column-holder">
  <div class="" style="float: left">
    <button
      style="font-weight: normal"
      translate
      [routerLink]="['/user/dashboard']"
      class="btn-primary"
      igxButton="raised"
      igxRipple
    >
      <span class="icon-Union-2"></span> &nbsp; Dashboard
    </button>
  </div>
  <form class="input-group-form" [formGroup]="logSearchForm" (ngSubmit)="applyFilters(true)">
    <div class="search-area">
      <div class="box">
        <input
          #applicationName
          data-description="'Application Name'"
          class="form-control"
          type="search"
          placeholder="{{ 'Application Name' | translate }}"
          formControlName="applicationName"
        />
        <span class="icon-cheveron-down" id="chev" (click)="clickEvent($event)"></span>
        <div class="dropdown-search" [ngClass]="{ active: toggleBtn }">
          <div class="dropdown" (clickOutside)="onClickedOutside($event)">
            <a (click)="toggleBtn = false" class="icon-cancel"></a>
            <ul class="row">
              <li class="col-lg-6">
                <igx-input-group>
                  <label igxLabel for="level" translate>Level</label>
                  <input #level data-description="'Level'" igxInput type="text" formControlName="level" name="level" />
                </igx-input-group>
              </li>

              <li class="col-lg-6">
                <igx-input-group>
                  <label igxLabel for="message" translate>Message</label>
                  <input
                    #message
                    data-description="Message"
                    igxInput
                    type="text"
                    formControlName="message"
                    name="message"
                  />
                </igx-input-group>
              </li>
              <li class="col-lg-6">
                <igx-input-group>
                  <label igxLabel for="correlationId" translate>correlation_id</label>
                  <input
                    #correlationId
                    data-description="Correlation Id"
                    igxInput
                    type="text"
                    formControlName="correlationId"
                    name="correlationId"
                  />
                </igx-input-group>
              </li>
              <li class="col-lg-6">
                <igx-input-group>
                  <label igxLabel for="timeStamp" translate>Time Stamp</label>
                  <input
                    [owlDateTime]="dt1"
                    #timeStamp
                    igxInput
                    [owlDateTimeTrigger]="dt1"
                    placeholder="{{ 'Time Stamp' | translate }}"
                    name="timeStamp"
                    id="timeStamp"
                    type="text"
                    data-description="Time Stamp"
                    formControlName="timeStamp"
                    (focus)="dateInputFocused()"
                  />
                  <span [owlDateTimeTrigger]="dt1" id="cal1"><i class="fad fa-calendar"></i></span>
                  <owl-date-time
                    #dt1
                    id="cal"
                    (afterPickerOpen)="calendarOpen()"
                    (afterPickerClosed)="calendarClosed()"
                  ></owl-date-time>
                </igx-input-group>
              </li>

              <li class="col-lg-12">
                <button class="btn btn-primary" translate>Search</button>
                <button (click)="resetFilters()" type="button" class="btn btn-default" translate>Reset</button>
              </li>
            </ul>
          </div>
        </div>
        <span class="icon-Path-1941" (click)="applyFilters(true)"></span>
      </div>
    </div>
  </form>
  <div class="tags-area" *ngIf="filterTags.length > 0">
    <ul>
      <li><span class="active-filter" translate>Active Filters: </span></li>
      <li *ngFor="let tag of filterTags; index as i">
        <span class="" *ngIf="tag.Description === 'Time Stamp'"
          >{{ tag.Description | translate }} : {{ dateFormatter(tag.Value) }}</span
        >
        <span class="" *ngIf="tag.Description !== 'Time Stamp'"
          >{{ tag.Description | translate }}: {{ tag.Value }}</span
        >
        <a (click)="removeFilter(tag.Property)" class="icon-cancel-circle"></a>
      </li>
    </ul>
  </div>
  <div class="grid__wrapper">
    <igx-grid
      #grid1
      [data]="data | async"
      width="100%"
      [height]="null"
      [paging]="true"
      displayDensity="cosy"
      [emptyGridMessage]="'There are no records to display' | translate"
      [paginationTemplate]="customPager"
      [cellSelection]="'none'"
    >
      <igx-column field="applicationName" width="200px">
        <ng-template igxHeader let-column>
          <div class="mysortingArea" (click)="sort(column.field)">
            <a translate> Application Name </a>
            <span style="float: right;">
              <i class="fas fa-arrow-up" *ngIf="order === 'ASC' && columnName === column.field"></i
              ><i class="fas fa-arrow-down" *ngIf="order === 'DESC' && columnName === column.field"></i>
            </span>
          </div>
        </ng-template>
      </igx-column>

      <igx-column field="correlationId" width="200px">
        <ng-template igxHeader let-column>
          <div class="mysortingArea" (click)="sort(column.field)">
            <a translate> correlation_id </a>
            <span style="float: right;">
              <i class="fas fa-arrow-up" *ngIf="order === 'ASC' && columnName === column.field"></i
              ><i class="fas fa-arrow-down" *ngIf="order === 'DESC' && columnName === column.field"></i>
            </span>
          </div>
        </ng-template>
      </igx-column>

      <igx-column field="level" width="150px">
        <ng-template igxHeader let-column>
          <div class="mysortingArea" (click)="sort(column.field)">
            <a translate> Level </a>
            <span style="float: right;">
              <i class="fas fa-arrow-up" *ngIf="order === 'ASC' && columnName === column.field"></i
              ><i class="fas fa-arrow-down" *ngIf="order === 'DESC' && columnName === column.field"></i>
            </span>
          </div>
        </ng-template>
        <ng-template igxCell let-value>
          {{ value | slice: 0:30 }}
        </ng-template>
      </igx-column>

      <igx-column field="message" width="500px">
        <ng-template igxHeader let-column>
          <div class="mysortingArea" (click)="sort(column.field)">
            <a translate> Message </a>
            <span style="float: right;">
              <i class="fas fa-arrow-up" *ngIf="order === 'ASC' && columnName === column.field"></i
              ><i class="fas fa-arrow-down" *ngIf="order === 'DESC' && columnName === column.field"></i>
            </span>
          </div>
        </ng-template>
        <ng-template igxCell let-value>
          <div #target="tooltipTarget" [igxTooltipTarget]="tooltipRef">{{ value | slice: 0:300 }}</div>
          <div #tooltipRef="tooltip" igxTooltip>
            {{ value }}
          </div>
        </ng-template>
      </igx-column>

      <igx-column field="exception" width="500px">
        <ng-template igxHeader let-column>
          <div class="mysortingArea" (click)="sort(column.field)">
            <a translate> Exception </a>
            <span style="float: right;">
              <i class="fas fa-arrow-up" *ngIf="order === 'ASC' && columnName === column.field"></i
              ><i class="fas fa-arrow-down" *ngIf="order === 'DESC' && columnName === column.field"></i>
            </span>
          </div>
        </ng-template>
        <ng-template igxCell let-value>
          <div #target="tooltipTarget" [igxTooltipTarget]="tooltipRef">{{ value | slice: 0:300 }}</div>
          <div #tooltipRef="tooltip" igxTooltip>
            {{ value }}
          </div>
        </ng-template>
      </igx-column>

      <igx-column field="timeStamp" width="200px">
        <ng-template igxHeader let-column>
          <div class="mysortingArea" (click)="sort(column.field)">
            <a translate> Time </a>
            <span style="float: right;">
              <i class="fas fa-arrow-up" *ngIf="order === 'ASC' && columnName === column.field"></i
              ><i class="fas fa-arrow-down" *ngIf="order === 'DESC' && columnName === column.field"></i>
            </span>
          </div>
        </ng-template>
        <ng-template igxCell let-value>
          {{ dateFormatter(value) }}
        </ng-template>
      </igx-column>

      <ng-template igxGridDetail let-dataItem>
        <div style="width:100%;">
          {{ dataItem.exception }}
        </div>
      </ng-template>
    </igx-grid>

    <ng-template #customPager let-api>
      <igx-paginator
        #paginator
        [totalRecords]="totalCount"
        [(perPage)]="perPage"
        [selectLabel]="'Records per page:' | translate"
        [selectOptions]="selectOptions"
        [displayDensity]="grid1.displayDensity"
        (pageChange)="paginate($event)"
        (perPageChange)="perPageChangeFn($event)"
      >
      </igx-paginator>
    </ng-template>
  </div>
</div>
